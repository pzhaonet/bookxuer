<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>学R—零基础学 R 语言</title>
  <meta name="description" content="This is a book for R rookies.">
  <meta name="generator" content="bookdown 0.5 and GitBook 2.6.7">

  <meta property="og:title" content="学R—零基础学 R 语言" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a book for R rookies." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="学R—零基础学 R 语言" />
  
  <meta name="twitter:description" content="This is a book for R rookies." />
  

<meta name="author" content="赵鹏, 李怡">


<meta name="date" content="2017-09-15">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="secstart.html">
<link rel="next" href="secplot.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="css\style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R菜鸟入门 （赵鹏 李怡 著）</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>读者留言选登</a></li>
<li class="chapter" data-level="" data-path="secpre1.html"><a href="secpre1.html"><i class="fa fa-check"></i>序言一（朱彤）</a></li>
<li class="chapter" data-level="" data-path="secpre2.html"><a href="secpre2.html"><i class="fa fa-check"></i>序言二（谢益辉）</a></li>
<li class="chapter" data-level="" data-path="secstory.html"><a href="secstory.html"><i class="fa fa-check"></i>前言：思 R 不学则殆</a><ul>
<li class="chapter" data-level="" data-path="secstory.html"><a href="secstory.html#secstory1"><i class="fa fa-check"></i>R的学习困境</a></li>
<li class="chapter" data-level="" data-path="secstory.html"><a href="secstory.html#secstory3"><i class="fa fa-check"></i>本书如何使用</a></li>
<li class="chapter" data-level="" data-path="secstory.html"><a href="secstory.html#secstory4"><i class="fa fa-check"></i>致谢</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="secstart.html"><a href="secstart.html"><i class="fa fa-check"></i><b>1</b> 初见</a><ul>
<li class="chapter" data-level="1.1" data-path="secstart.html"><a href="secstart.html#secstart-2"><i class="fa fa-check"></i><b>1.1</b> 结缘：下载安装</a></li>
<li class="chapter" data-level="1.2" data-path="secstart.html"><a href="secstart.html#secstart-3"><i class="fa fa-check"></i><b>1.2</b> 第一次畅谈：计算</a></li>
<li class="chapter" data-level="1.3" data-path="secstart.html"><a href="secstart.html#secstart-4"><i class="fa fa-check"></i><b>1.3</b> 第一张留影：作图</a></li>
<li class="chapter" data-level="1.4" data-path="secstart.html"><a href="secstart.html#secstartpost"><i class="fa fa-check"></i><b>1.4</b> 课外活动：表白</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="secdata.html"><a href="secdata.html"><i class="fa fa-check"></i><b>2</b> 数据</a><ul>
<li class="chapter" data-level="2.1" data-path="secdata.html"><a href="secdata.html#secdata-1"><i class="fa fa-check"></i><b>2.1</b> 输入：读取文件</a></li>
<li class="chapter" data-level="2.2" data-path="secdata.html"><a href="secdata.html#secdata-2"><i class="fa fa-check"></i><b>2.2</b> 计算：数据处理和作图</a></li>
<li class="chapter" data-level="2.3" data-path="secdata.html"><a href="secdata.html#secdata-3"><i class="fa fa-check"></i><b>2.3</b> 输出：保存文件</a></li>
<li class="chapter" data-level="2.4" data-path="secdata.html"><a href="secdata.html#secdatapost"><i class="fa fa-check"></i><b>2.4</b> 课外活动：有R伴我走天涯</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="secplot.html"><a href="secplot.html"><i class="fa fa-check"></i><b>3</b> 作图</a><ul>
<li class="chapter" data-level="3.1" data-path="secplot.html"><a href="secplot.html#secplot-1"><i class="fa fa-check"></i><b>3.1</b> 控制图像：线型，点状，颜色</a></li>
<li class="chapter" data-level="3.2" data-path="secplot.html"><a href="secplot.html#secplot-2"><i class="fa fa-check"></i><b>3.2</b> 丰富内容：直线、网格和图例</a></li>
<li class="chapter" data-level="3.3" data-path="secplot.html"><a href="secplot.html#secplot-3"><i class="fa fa-check"></i><b>3.3</b> 多图合一：三种布局</a></li>
<li class="chapter" data-level="3.4" data-path="secplot.html"><a href="secplot.html#secplot-4"><i class="fa fa-check"></i><b>3.4</b> 保存图片：pdf，png，jpg</a></li>
<li class="chapter" data-level="3.5" data-path="secplot.html"><a href="secplot.html#secplotpost"><i class="fa fa-check"></i><b>3.5</b> 课外活动： R的毛坯房与精装修</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="secfit.html"><a href="secfit.html"><i class="fa fa-check"></i><b>4</b> 拟合</a><ul>
<li class="chapter" data-level="4.1" data-path="secfit.html"><a href="secfit.html#secfit-1"><i class="fa fa-check"></i><b>4.1</b> 线性拟合：散点图的趋势线</a></li>
<li class="chapter" data-level="4.2" data-path="secfit.html"><a href="secfit.html#secfit-2"><i class="fa fa-check"></i><b>4.2</b> 在绘图区添加数学表达式</a></li>
<li class="chapter" data-level="4.3" data-path="secfit.html"><a href="secfit.html#secfit-3"><i class="fa fa-check"></i><b>4.3</b> 非线性拟合：一个指数递减模型</a></li>
<li class="chapter" data-level="4.4" data-path="secfit.html"><a href="secfit.html#secfitpost"><i class="fa fa-check"></i><b>4.4</b> 课外活动：助理团与自助餐</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="secloop.html"><a href="secloop.html"><i class="fa fa-check"></i><b>5</b> 循环</a><ul>
<li class="chapter" data-level="5.1" data-path="secloop.html"><a href="secloop.html#secloop-1"><i class="fa fa-check"></i><b>5.1</b> 假如没有循环</a></li>
<li class="chapter" data-level="5.2" data-path="secloop.html"><a href="secloop.html#secloop-2"><i class="fa fa-check"></i><b>5.2</b> 循环是个救世主</a></li>
<li class="chapter" data-level="5.3" data-path="secloop.html"><a href="secloop.html#secloop-3"><i class="fa fa-check"></i><b>5.3</b> 人口增长模型</a></li>
<li class="chapter" data-level="5.4" data-path="secloop.html"><a href="secloop.html#secloop-4"><i class="fa fa-check"></i><b>5.4</b> 制作动画</a></li>
<li class="chapter" data-level="5.5" data-path="secloop.html"><a href="secloop.html#secloop-5"><i class="fa fa-check"></i><b>5.5</b> 超越循环</a></li>
<li class="chapter" data-level="5.6" data-path="secloop.html"><a href="secloop.html#seclooppost"><i class="fa fa-check"></i><b>5.6</b> 课外活动：信息提示</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="secif.html"><a href="secif.html"><i class="fa fa-check"></i><b>6</b> 分支</a><ul>
<li class="chapter" data-level="6.1" data-path="secif.html"><a href="secif.html#secif-1"><i class="fa fa-check"></i><b>6.1</b> 判断：逻辑运算</a></li>
<li class="chapter" data-level="6.2" data-path="secif.html"><a href="secif.html#secif-2"><i class="fa fa-check"></i><b>6.2</b> 选择：如果，那么，否则</a></li>
<li class="chapter" data-level="6.3" data-path="secif.html"><a href="secif.html#secifpost"><i class="fa fa-check"></i><b>6.3</b> 课外活动：复活节</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="secoffice.html"><a href="secoffice.html"><i class="fa fa-check"></i><b>7</b> 办公</a><ul>
<li class="chapter" data-level="7.1" data-path="secoffice.html"><a href="secoffice.html#secoffice-1"><i class="fa fa-check"></i><b>7.1</b> 从Excel到R代码</a></li>
<li class="chapter" data-level="7.2" data-path="secoffice.html"><a href="secoffice.html#secoffice-2"><i class="fa fa-check"></i><b>7.2</b> 从Word到R文档</a></li>
<li class="chapter" data-level="7.3" data-path="secoffice.html"><a href="secoffice.html#secoffice-3"><i class="fa fa-check"></i><b>7.3</b> 从Powerpoint到R幻灯片</a></li>
<li class="chapter" data-level="7.4" data-path="secoffice.html"><a href="secoffice.html#secofficepost"><i class="fa fa-check"></i><b>7.4</b> 课外活动：丰富多彩的幻灯片</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="secmid.html"><a href="secmid.html"><i class="fa fa-check"></i><b>8</b> 习题</a><ul>
<li class="chapter" data-level="8.1" data-path="secmid.html"><a href="secmid.html#secmid-1"><i class="fa fa-check"></i><b>8.1</b> 向量、矩阵、数据框和列表</a></li>
<li class="chapter" data-level="8.2" data-path="secmid.html"><a href="secmid.html#secmid-2"><i class="fa fa-check"></i><b>8.2</b> A卷：照猫画虎题</a></li>
<li class="chapter" data-level="8.3" data-path="secmid.html"><a href="secmid.html#secmid-2"><i class="fa fa-check"></i><b>8.3</b> B卷：自由发挥题</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="secfunction.html"><a href="secfunction.html"><i class="fa fa-check"></i><b>9</b> 函数</a><ul>
<li class="chapter" data-level="9.1" data-path="secfunction.html"><a href="secfunction.html#secfunction-1"><i class="fa fa-check"></i><b>9.1</b> 内置函数：全自动厨师机</a></li>
<li class="chapter" data-level="9.2" data-path="secfunction.html"><a href="secfunction.html#secfunction-2"><i class="fa fa-check"></i><b>9.2</b> 自定义函数：自制厨师机</a></li>
<li class="chapter" data-level="9.3" data-path="secfunction.html"><a href="secfunction.html#secfunction-3"><i class="fa fa-check"></i><b>9.3</b> 扩展包：美食王国</a></li>
<li class="chapter" data-level="9.4" data-path="secfunction.html"><a href="secfunction.html#secfunction-4"><i class="fa fa-check"></i><b>9.4</b> 包的开发：开疆拓土</a></li>
<li class="chapter" data-level="9.5" data-path="secfunction.html"><a href="secfunction.html#secfunctionpost"><i class="fa fa-check"></i><b>9.5</b> 课外活动：餐后甜点</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="secchar.html"><a href="secchar.html"><i class="fa fa-check"></i><b>10</b> 字符</a><ul>
<li class="chapter" data-level="10.1" data-path="secchar.html"><a href="secchar.html#secchar-1"><i class="fa fa-check"></i><b>10.1</b> 狐狸从懒狗身上跳过</a></li>
<li class="chapter" data-level="10.2" data-path="secchar.html"><a href="secchar.html#secchar-2"><i class="fa fa-check"></i><b>10.2</b> 千字文的重复字</a></li>
<li class="chapter" data-level="10.3" data-path="secchar.html"><a href="secchar.html#section-10.3"><i class="fa fa-check"></i><b>10.3</b> 整理读书笔记</a></li>
<li class="chapter" data-level="10.4" data-path="secchar.html"><a href="secchar.html#seccharpost"><i class="fa fa-check"></i><b>10.4</b> 课外活动：张无忌的困惑</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="secmap.html"><a href="secmap.html"><i class="fa fa-check"></i><b>11</b> 地图</a><ul>
<li class="chapter" data-level="11.1" data-path="secmap.html"><a href="secmap.html#secmap-1"><i class="fa fa-check"></i><b>11.1</b> 绘制点阵地图</a></li>
<li class="chapter" data-level="11.2" data-path="secmap.html"><a href="secmap.html#secmap-2"><i class="fa fa-check"></i><b>11.2</b> 绘制矢量地图</a></li>
<li class="chapter" data-level="11.3" data-path="secmap.html"><a href="secmap.html#secmap-3"><i class="fa fa-check"></i><b>11.3</b> 绘制交互地图</a></li>
<li class="chapter" data-level="11.4" data-path="secmap.html"><a href="secmap.html#secmappost"><i class="fa fa-check"></i><b>11.4</b> 课外活动：绘制动画地图</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="sectime.html"><a href="sectime.html"><i class="fa fa-check"></i><b>12</b> 时间</a><ul>
<li class="chapter" data-level="12.1" data-path="sectime.html"><a href="sectime.html#sectime-1"><i class="fa fa-check"></i><b>12.1</b> 时刻数据的获取</a></li>
<li class="chapter" data-level="12.2" data-path="sectime.html"><a href="sectime.html#sectime-2"><i class="fa fa-check"></i><b>12.2</b> 时刻数据的格式</a></li>
<li class="chapter" data-level="12.3" data-path="sectime.html"><a href="sectime.html#sectime-3"><i class="fa fa-check"></i><b>12.3</b> 时刻数据的计算</a></li>
<li class="chapter" data-level="12.4" data-path="sectime.html"><a href="sectime.html#sectimepost"><i class="fa fa-check"></i><b>12.4</b> 课外活动：夏令时</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="secfile.html"><a href="secfile.html"><i class="fa fa-check"></i><b>13</b> 批量处理文件</a><ul>
<li class="chapter" data-level="13.1" data-path="secfile.html"><a href="secfile.html#secfile-1"><i class="fa fa-check"></i><b>13.1</b> 批量整理照片文件</a></li>
<li class="chapter" data-level="13.2" data-path="secfile.html"><a href="secfile.html#secfile-2"><i class="fa fa-check"></i><b>13.2</b> 从网页批量下载和整理图片</a></li>
<li class="chapter" data-level="13.3" data-path="secfile.html"><a href="secfile.html#secfile-3"><i class="fa fa-check"></i><b>13.3</b> 从大量文件里提取汇总信息</a></li>
<li class="chapter" data-level="13.4" data-path="secfile.html"><a href="secfile.html#secfilepost"><i class="fa fa-check"></i><b>13.4</b> 课外活动：打通任督二脉</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="bookdown.html"><a href="bookdown.html"><i class="fa fa-check"></i><b>14</b> 论文书稿写作</a><ul>
<li class="chapter" data-level="14.1" data-path="bookdown.html"><a href="bookdown.html#quick-start"><i class="fa fa-check"></i><b>14.1</b> 魅力不可挡</a></li>
<li class="chapter" data-level="14.2" data-path="bookdown.html"><a href="bookdown.html#preparation"><i class="fa fa-check"></i><b>14.2</b> 准备工作</a></li>
<li class="chapter" data-level="14.3" data-path="bookdown.html"><a href="bookdown.html#magic"><i class="fa fa-check"></i><b>14.3</b> 见证奇迹的时刻</a></li>
<li class="chapter" data-level="14.4" data-path="bookdown.html"><a href="bookdown.html#article"><i class="fa fa-check"></i><b>14.4</b> 撰写学术论文</a></li>
<li class="chapter" data-level="14.5" data-path="bookdown.html"><a href="bookdown.html#thesis"><i class="fa fa-check"></i><b>14.5</b> 撰写学位论文</a></li>
<li class="chapter" data-level="14.6" data-path="bookdown.html"><a href="bookdown.html#mindmap"><i class="fa fa-check"></i><b>14.6</b> 生成思维导图</a></li>
<li class="chapter" data-level="14.7" data-path="bookdown.html"><a href="bookdown.html#diary"><i class="fa fa-check"></i><b>14.7</b> 撰写散文和日记</a></li>
<li class="chapter" data-level="14.8" data-path="bookdown.html"><a href="bookdown.html#write-chords"><i class="fa fa-check"></i><b>14.8</b> 记录吉他谱</a></li>
<li class="chapter" data-level="14.9" data-path="bookdown.html"><a href="bookdown.html#secbookdownpost"><i class="fa fa-check"></i><b>14.9</b> 课外活动：创建新模板</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="blogdown.html"><a href="blogdown.html"><i class="fa fa-check"></i><b>15</b> 搭建小型网站</a><ul>
<li class="chapter" data-level="15.1" data-path="blogdown.html"><a href="blogdown.html#blogdown-intro"><i class="fa fa-check"></i><b>15.1</b> 准备工作</a></li>
<li class="chapter" data-level="15.2" data-path="blogdown.html"><a href="blogdown.html#blogdown-blog"><i class="fa fa-check"></i><b>15.2</b> 搭建个人博客</a></li>
<li class="chapter" data-level="15.3" data-path="blogdown.html"><a href="blogdown.html#blogdown-academic"><i class="fa fa-check"></i><b>15.3</b> 搭建科研网站</a></li>
<li class="chapter" data-level="15.4" data-path="blogdown.html"><a href="blogdown.html#secblogdownpost"><i class="fa fa-check"></i><b>15.4</b> 课外活动：搭建自己的网站</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="secfinal.html"><a href="secfinal.html"><i class="fa fa-check"></i><b>16</b> 在工作中应用</a><ul>
<li class="chapter" data-level="16.1" data-path="secfinal.html"><a href="secfinal.html#secfinal-2"><i class="fa fa-check"></i><b>16.1</b> 自动完成业务报表</a></li>
<li class="chapter" data-level="16.2" data-path="secfinal.html"><a href="secfinal.html#secfinal-1"><i class="fa fa-check"></i><b>16.2</b> 可重复研究报告</a></li>
<li class="chapter" data-level="16.3" data-path="secfinal.html"><a href="secfinal.html#secfinalpost"><i class="fa fa-check"></i><b>16.3</b> 课外活动：学以致用</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="secback.html"><a href="secback.html"><i class="fa fa-check"></i>后记：学 R 时习之</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>参考文献</a></li>
<li class="appendix"><span><b>附录</b></span></li>
<li class="chapter" data-level="A" data-path="markdown.html"><a href="markdown.html"><i class="fa fa-check"></i><b>A</b> Markdown 和 bookdown 语法速查</a></li>
<li class="chapter" data-level="B" data-path="secqa.html"><a href="secqa.html"><i class="fa fa-check"></i><b>B</b> 答疑</a><ul>
<li class="chapter" data-level="" data-path="secqa.html"><a href="secqa.html#secqa-mis"><i class="fa fa-check"></i>菜鸟常犯错误和常见问题</a></li>
<li class="chapter" data-level="" data-path="secqa.html"><a href="secqa.html#secqaa"><i class="fa fa-check"></i>习题参考答案</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org/yihui/bookdown/" target="blank">消灭word暴政，世界属于bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">学R—零基础学 R 语言</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="secdata" class="section level1">
<h1><span class="header-section-number">第2章</span> 数据</h1>
<pre><code>    数据！数据！数据！没有泥的话我没法做出砖。</code></pre>
<blockquote>
<p>—夏洛克·福尔摩斯</p>
</blockquote>
<pre><code>    要是你的数据烂，不管啥统计程序都没救。</code></pre>
<!---
>
> You can't expect statistical procedures to rescue you from poor data.
>
--->
<blockquote>
<p>— Berton Gunter, April 2005</p>
</blockquote>
<p>在第<a href="secstart.html#secstart">1</a>章里，我们学会了用R进行常规的数学运算和统计计算，并且做出了三张图：大气二氧化碳浓度时间序列，降水的季节变化图，北京的 PM<sub>2.5</sub> 日变化图。好像已经把R语言学完了。只是，总不能每次都把数据一个一个敲到代码里吧，也不能只使用R自带的数据自娱自乐吧。要是处理你自己文件里的大量数据呢？本篇就解决这个问题。</p>
<p>本书里我们会使用示例数据，方便你跟我们同步操作。示例数据文件可以请R来自动生成。运行下面这两行命令：</p>
<p></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dir.create</span>(<span class="st">&#39;c:/r4r&#39;</span>)
<span class="kw">write.csv</span>(<span class="kw">as.data.frame</span>(<span class="kw">t</span>(<span class="kw">matrix</span>(
  co2, <span class="dv">12</span>, <span class="dt">dimnames =</span> <span class="kw">list</span>(
    month.abb, <span class="kw">unique</span>(<span class="kw">floor</span>(<span class="kw">time</span>(co2))))))), 
  <span class="dt">file =</span> <span class="st">&#39;c:/r4r/co2.csv&#39;</span>)</code></pre></div>
<p>将来我们会解释这两条代码的含义，现在你大可略去，只管去c盘找到一个名叫r4r文件夹，里面有个名叫co2.csv的文件。这就是我们做示范的示例数据文件，你就当作是从我们的光盘上拷贝过来的吧。请在学习本书的过程中保留“c:/r4r”这个文件夹，我们在后续章节所做的示范都要用到它。</p>
<p>请用Excel或记事本打开co2.csv这个文件。这是个数据表，内容是1959年1月到1997年12月夏威夷Mauna Loa观测站的大气二氧化碳浓度，以年份为行，以月份为列。不要做任何修改，我们现在假定这是你即将处理的数据文件，看看如何对其中的数据进行操作。</p>
<div id="secdata-1" class="section level2">
<h2><span class="header-section-number">2.1</span> 输入：读取文件</h2>
<p>读取文件，就是让R把数据读进R的脑子里。</p>
<p>如果你喜欢拷贝粘贴的方式，那么可以用 Excel 打开数据文件 co2.csv ，用鼠标选中全部数据区（ctrl+a），拷贝，然后在 R 中用下面的代码读取剪切板里的数据（试一下“tab小助理”。以后每个长命令都用一下，养成习惯）：</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mydata1 &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="dt">file =</span> <span class="st">&quot;clipboard&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>这条指令的含义是：读取剪切板里的数据，保存到mydata1这个数据框变量里。<code>header = TRUE</code> 翻译过来就是“文件头是<strong>真</strong>有啊“，意思是数据表的第一行是列名称。</p>
<p>这时，注意观察RStudio的 右上窗，出现了 mydata1 的信息。鼠标单击可以查看内容，也可以用输入代码并运行：</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mydata1</code></pre></div>
<pre><code>##       X    Jan    Feb    Mar    Apr    May    Jun    Jul
## 1  1959 315.42 316.31 316.50 317.56 318.13 318.00 316.39
## 2  1960 316.27 316.81 317.42 318.87 319.87 319.43 318.01
## 3  1961 316.73 317.54 318.38 319.31 320.42 319.61 318.42
## 4  1962 317.78 318.40 319.53 320.42 320.85 320.45 319.45
## 5  1963 318.58 318.92 319.70 321.22 322.08 321.31 319.58
## 6  1964 319.41 320.07 320.74 321.40 322.06 321.73 320.27
## ......
## 38 1996 362.09 363.29 364.06 364.76 365.45 365.01 363.70
## 39 1997 363.23 364.06 364.61 366.40 366.84 365.68 364.52</code></pre>
<p>好了，读取数据就是这么简单。如果这已经满足你的需求，那么就可以跳至第<a href="secdata.html#secdata-2">2.2</a>节，进行后续操作了。不过，我们建议你耐心把本节读完。因为，用拷贝粘贴的方式读取数据，优点是简单灵活易上手，适合临时用一下；缺点是重复性差，下回你可能忘了上次拷贝的是哪个区域的数据，这不是 R 的做事风格。更多情况下，我们要告诉R，数据文件保存在哪里，只需把上面命令的剪切板<code>clipboard</code>换成数据文件的路径即可。下面我们详细介绍这种方法。</p>
<p>不习惯命令行的用户，可以通过下面的指令获取这个文件的路径（请在敲入时练习一下前面说过的“箭头快捷键“和“tab小助理”）：</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">myfile1 &lt;-<span class="st"> </span><span class="kw">file.choose</span>()</code></pre></div>
<p>在弹出的窗口中选择文件c盘下r4r文件夹里的co2.csv。</p>
<p>好了，现在我们看看myfile1的值是什么。在RStudio运行：</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">myfile1</code></pre></div>
<pre><code>## [1] &quot;c:/r4r/co2.csv&quot;</code></pre>
<p>是刚才选取文件的路径。这是获取路径的方法之一，比较符合很多人喜欢鼠标选择文件的习惯，但比较麻烦，每次使用这个代码时都得点一次。一般来说，我们存放数据的路径是固定不变的，所以更常用的方法，是在代码里直接敲入文件路径：</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">myfile2 &lt;-<span class="st"> &quot;c:/r4r/co2.csv&quot;</span>
myfile2</code></pre></div>
<pre><code>## [1] &quot;c:/r4r/co2.csv&quot;</code></pre>
<p>跟鼠标选取文件的结果完全相同。</p>
<p>注意：</p>
<ul>
<li>路径的名称前后要用引号（单双都行，但要成对儿），表示这是一个字符串。</li>
<li>文件路径中上下级文件夹之间的斜线必须是斜线（<code>/</code> ）而不是反斜线（<code>\</code>）， Windows用户一定要注意！其中的道理我们暂不深究。</li>
</ul>
<!---
现在，输入并运行：


```r
file.show(myfile2) # 查看文件
```

文件就会用默认程序打开，跟在浏览器中双击打开的效果是一样的。
-->
<p>myfile2里存储的文件路径，并不是文件内容。R现在知道文件在哪里，却不知道里面是什么内容。现在，我们让 R 读取文件的内容。</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mydata2 &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="dt">file =</span> myfile2, 
                      <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>)
mydata2</code></pre></div>
<p><code>sep</code>参数表示数据列的分隔符，这里设置为逗号，表示读取逗号分隔的数据。</p>
<p>你也许会说，<code>read.table()</code> 括号里那么多东西，用起来也太复杂了吧？怎么记得住？对，谁都记不住，现在我们有请助理团的第二位成员隆重登场！只需要把光标放到代码<code>read.table</code>的任何一个字符处，按键盘的F1键，RStudio此时会在右下面板显示帮助信息，有详细的解释和实例。好好读读帮助吧，以后你会发现，F1小助理是仅次于tab的常用操作。除了tab小助理和F1小助理外，以后我们会介绍更多的小助理跟你见面。</p>

<div class="theorem">
<p><span id="thm:thm-tools3" class="theorem"><strong>小贴士 2.1  </strong></span>R菜鸟入门三大法宝</p>
<ul>
<li><p>第一法宝：助理！以F1和tab键为首的豪华助理团，简直就是身边的诸葛亮，可以随时方便地寻求帮助。</p></li>
<li><p>第二法宝：猎狗！就是搜索引擎。遇见问题不懂就上网搜，你会发现，早就有人提出类似的问题并解决了。</p></li>
<li>第三法宝：顾问！就是论坛。内事不决问统都<a href="#fn11" class="footnoteRef" id="fnref11"><sup>11</sup></a>（中文论坛），外事不决问爆栈<a href="#fn12" class="footnoteRef" id="fnref12"><sup>12</sup></a>（英文论坛）。</li>
</ul>
</div>
<p></p>
<p>为了省事儿，我们可以用<code>read.table()</code>的瘦身简化版<code>read.csv()</code>函数，用来专门读取逗号分隔的.csv文件：</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mydata2 &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="dt">file =</span> myfile2)</code></pre></div>
<p>跟上一条指令的效果完全相同。到此为止，数据文件中的数据就被R读进了他的脑子里。mydata1和mydata2这种二维表格数据，叫做“数据框”。</p>
<p>你可能会觉得麻烦，怎么在Excel里双击一下就搞定的事，在R里边却这么麻烦？是的，R对数据的读入并非“傻瓜”操作，也许在读数据上R比Excel麻烦10倍，但只要读进去了，后面会省事百倍千倍。而且，如果需要读入千百个数据文件，那么配合第<a href="secloop.html#secloop">5</a>章的循环语句可以轻松搞定，而不必双击千百次。相信我们，磨刀不误砍柴工。</p>
<p>其实，上面的过程是一套分解动作，让我们容易理解读取数据的过程。实际应用时，只需一行代码：</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mydata2 &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="dt">file =</span> <span class="st">&quot;c:/r4r/co2.csv&quot;</span>)</code></pre></div>

<div class="lemma">
<span id="lem:unnamed-chunk-37" class="lemma"><strong>思考 2.1  </strong></span>细心的你也许会留意，本章开头有个<code>write.csv()</code>函数，跟<code>read.csv()</code>有什么关系？既然<code>read.csv()</code>是<code>read.table()</code>的瘦身版，那么会不会有个<code>write.table()</code>函数呢？要弄清楚这些问题，请试试你的三大法宝。
</div>
<p></p>
<p>在RStudio中，像ctrl+shift+n、tab和F1这样的快捷键操作还有很多。从RStudio菜单栏选择Tools – Keyboard Shortcuts Help，或者直接按alt+shift+k键，就会弹出一本快捷键魔法书。</p>
</div>
<div id="secdata-2" class="section level2">
<h2><span class="header-section-number">2.2</span> 计算：数据处理和作图</h2>
<p>R把数据读入脑子后，就可以开始干活儿了。</p>
<p>我们先让R对数据画个图，看起来更直观（图<a href="secdata.html#fig:fig-pair">2.1</a>）：</p>
<p></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(mydata2)</code></pre></div>
<div class="figure"><span id="fig:fig-pair"></span>
<img src="r4r_files/figure-html/fig-pair-1.png" alt="多张小图一次完成（局部展示）." width="100%" />
<p class="caption">
图 2.1: 多张小图一次完成（局部展示）.
</p>
</div>
<p>Bingo！多张小图一次完成！这就是事半功倍的效果。</p>
<pre><code>    你想多懒就多懒，并不耽误高效率。</code></pre>
<!---
>
> You can be maximally lazy, but still be efficient.
>
--->
<blockquote>
<p>— Kevin Murphy, September 2003</p>
</blockquote>
<p>这是任意两列的散点图。画的小图表示的是什么呢？比如从上数第2行第4列的小图，跟它排在同一行的文字是左边的Jan，这是小图的纵坐标标签；跟小图排在同一列的文字是下方的Mar，这是小图的横坐标标签。所以这个小图展示的是以3月的二氧化碳浓度x，1月份的二氧化碳浓度为y的散点图。其他小图可以类推。那么，第1列小图，展示的就是各月二氧化碳浓度的逐年变化。</p>
<p>这么复杂的图，简单一条指令就轻松做出来了。追求高效人士的利器！</p>

<div class="lemma">
<span id="lem:unnamed-chunk-39" class="lemma"><strong>思考 2.2  </strong></span>使用Excel或其他你常用的作图软件，如何做出图<a href="secdata.html#fig:fig-pair">2.1</a>？
</div>
<p></p>
<p>我们一般在读入数据文件后的第一件事就是<code>plot()</code>一下，对数据有个整体的感觉。第二件事，一般是用<code>summary()</code>看看这个文件的总结报告，这个函数我们在第<a href="secstart.html#secstart">1</a>章已经打过照面了：</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(mydata2)</code></pre></div>
<pre><code>##        X             Jan             Feb       
##  Min.   :1959   Min.   :315.4   Min.   :316.3  
##  1st Qu.:1968   1st Qu.:323.1   1st Qu.:323.6  
##  Median :1978   Median :334.8   Median :335.2  
##  Mean   :1978   Mean   :336.4   Mean   :337.2  
##  3rd Qu.:1988   3rd Qu.:349.0   3rd Qu.:349.9  
##  Max.   :1997   Max.   :363.2   Max.   :364.1  
##       Mar             Apr             May       
##  Min.   :316.5   Min.   :317.6   Min.   :318.1  
##  1st Qu.:324.6   1st Qu.:325.7   1st Qu.:326.3  
##  Median :336.5   Median :337.6   Median :337.8  
##  Mean   :338.1   Mean   :339.3   Mean   :339.9  
##  3rd Qu.:350.6   3rd Qu.:352.1   3rd Qu.:352.9  
##  Max.   :364.6   Max.   :366.4   Max.   :366.8  
##       Jun             Jul             Aug       
##  Min.   :318.0   Min.   :316.4   Min.   :314.6  
##  1st Qu.:325.9   1st Qu.:324.9   1st Qu.:322.7  
##  Median :337.7   Median :336.4   Median :334.5  
##  Mean   :339.3   Mean   :337.9   Mean   :336.0  
##  3rd Qu.:352.3   3rd Qu.:350.8   3rd Qu.:349.1  
##  Max.   :365.7   Max.   :364.5   Max.   :362.6  
##       Sep             Oct             Nov       
##  Min.   :313.7   Min.   :313.2   Min.   :314.7  
##  1st Qu.:321.2   1st Qu.:320.9   1st Qu.:321.9  
##  Median :332.6   Median :332.4   Median :333.8  
##  Mean   :334.2   Mean   :334.2   Mean   :335.5  
##  3rd Qu.:347.4   3rd Qu.:347.4   3rd Qu.:348.8  
##  Max.   :360.2   Max.   :360.8   Max.   :362.5  
##       Dec       
##  Min.   :315.4  
##  1st Qu.:323.3  
##  Median :334.8  
##  Mean   :336.7  
##  3rd Qu.:350.0  
##  Max.   :364.3</code></pre>
<p>得到的是每一列数据（也就是各年各月二氧化碳浓度）的最大值、最小值、中位数、平均值函数，顺便还附送了四分位数（1st Qu.， 3rd Qu.）。什么是四分位数？试试猎狗。</p>
<pre><code>    放狗去搜。</code></pre>
<blockquote>
<p>— 谢益辉<a href="#fn13" class="footnoteRef" id="fnref13"><sup>13</sup></a></p>
</blockquote>
<p>如果我们想看看数据框里某个指定值，比如1995年9月二氧化碳的浓度，该怎么选取单元格呢？你还记得上一节我们是如何选取 4 月的降水量吗？<code>x[4]</code>。类似地，1995年是第37行，9月是第10列，所以：</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mydata2[<span class="dv">37</span>, <span class="dv">10</span>]</code></pre></div>
<pre><code>## [1] 358.11</code></pre>
<p>要选取多个行呢？若你还记得用<code>c()</code>生成一个向量，那就好办了，比如选取第10列的全部偶数行：</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mydata2[<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">10</span>,<span class="dv">12</span>,<span class="dv">14</span>,<span class="dv">16</span>,<span class="dv">18</span>,<span class="dv">20</span>,
          <span class="dv">22</span>,<span class="dv">24</span>,<span class="dv">26</span>,<span class="dv">28</span>,<span class="dv">30</span>,<span class="dv">32</span>,<span class="dv">34</span>,<span class="dv">36</span>,<span class="dv">38</span>), <span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 314.00 316.11 316.54 318.48 320.18 322.93 324.68 327.27
##  [9] 329.14 332.60 335.72 337.81 340.90 344.68 348.55 350.82
## [17] 352.94 355.84 359.51</code></pre>
<p>行数太多，逐个敲起来太麻烦了吧，高效人士的办法是用<code>seq()</code>函数生成个数列：</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mydata2[<span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">2</span>, <span class="dt">to =</span> <span class="dv">39</span>, <span class="dt">by =</span> <span class="dv">2</span>), <span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 314.00 316.11 316.54 318.48 320.18 322.93 324.68 327.27
##  [9] 329.14 332.60 335.72 337.81 340.90 344.68 348.55 350.82
## [17] 352.94 355.84 359.51</code></pre>
<p><code>seq(from = 2, to = 39, by = 2)</code> 表示以 2 为起点，39 为终点，间隔（即步长）为 2 生成一个数列。比如步长是1的话，就用<code>seq(from = 2, to = 39, by = 1)</code>，等同于<code>2:39</code>：</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mydata2[<span class="dv">2</span>:<span class="dv">39</span>, <span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 314.00 314.83 316.11 316.05 316.54 317.66 318.48 319.10
##  [9] 320.18 322.22 322.93 323.20 324.68 327.35 327.27 328.40
## [17] 329.14 331.42 332.60 333.75 335.72 336.52 337.81 339.69
## [25] 340.90 342.92 344.68 346.27 348.55 349.64 350.82 352.05
## [33] 352.94 353.67 355.84 358.11 359.51 360.24</code></pre>
<p>如果是选取整行或整列的话, 为了省事儿，可以空出来相应位置：</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mydata2[, <span class="dv">10</span>]  <span class="co"># 第10列全部。</span></code></pre></div>
<pre><code>##  [1] 313.68 314.00 314.83 316.11 316.05 316.54 317.66 318.48
##  [9] 319.10 320.18 322.22 322.93 323.20 324.68 327.35 327.27
## [17] 328.40 329.14 331.42 332.60 333.75 335.72 336.52 337.81
## [25] 339.69 340.90 342.92 344.68 346.27 348.55 349.64 350.82
## [33] 352.05 352.94 353.67 355.84 358.11 359.51 360.24</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mydata2[<span class="dv">37</span>, ]  <span class="co"># 第37行全部。</span></code></pre></div>
<pre><code>##       X    Jan    Feb    Mar    Apr    May   Jun    Jul
## 37 1995 359.98 361.03 361.66 363.48 363.82 363.3 361.94
##      Aug    Sep   Oct    Nov    Dec
## 37 359.5 358.11 357.8 359.61 360.74</code></pre>
<p>如果列数太多，总不能老去数第几列吧？别急，也可以用行或列名称来替代列数：</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mydata2[, <span class="st">&#39;Sep&#39;</span>]</code></pre></div>
<pre><code>##  [1] 313.68 314.00 314.83 316.11 316.05 316.54 317.66 318.48
##  [9] 319.10 320.18 322.22 322.93 323.20 324.68 327.35 327.27
## [17] 328.40 329.14 331.42 332.60 333.75 335.72 336.52 337.81
## [25] 339.69 340.90 342.92 344.68 346.27 348.55 349.64 350.82
## [33] 352.05 352.94 353.67 355.84 358.11 359.51 360.24</code></pre>
<p>或者用美元符号后面跟着列的名称：</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mydata2$Sep</code></pre></div>
<pre><code>##  [1] 313.68 314.00 314.83 316.11 316.05 316.54 317.66 318.48
##  [9] 319.10 320.18 322.22 322.93 323.20 324.68 327.35 327.27
## [17] 328.40 329.14 331.42 332.60 333.75 335.72 336.52 337.81
## [25] 339.69 340.90 342.92 344.68 346.27 348.55 349.64 350.82
## [33] 352.05 352.94 353.67 355.84 358.11 359.51 360.24</code></pre>
<p>列名称都有哪些呢？其实在输入$符号后，RStudio就立刻贴心地把所有列名称列出来了，供我们选择。如果没有出现，请咨询tab小助理。除此之外，用<code>names()</code>函数或<code>colnames()</code>函数可以查看列名称：</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(mydata2) <span class="co"># 或 colnames(mydata2)</span></code></pre></div>
<pre><code>##  [1] &quot;X&quot;   &quot;Jan&quot; &quot;Feb&quot; &quot;Mar&quot; &quot;Apr&quot; &quot;May&quot; &quot;Jun&quot; &quot;Jul&quot; &quot;Aug&quot;
## [10] &quot;Sep&quot; &quot;Oct&quot; &quot;Nov&quot; &quot;Dec&quot;</code></pre>
<p>第一列在原始文件中没有名字，所以R自动起了个名字叫做“X”。我们可以把它的列名称改为“year”：</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(mydata2)[<span class="dv">1</span>] &lt;-<span class="st"> &#39;year&#39;</span>
<span class="kw">names</span>(mydata2)</code></pre></div>
<pre><code>##  [1] &quot;year&quot; &quot;Jan&quot;  &quot;Feb&quot;  &quot;Mar&quot;  &quot;Apr&quot;  &quot;May&quot;  &quot;Jun&quot;  &quot;Jul&quot; 
##  [9] &quot;Aug&quot;  &quot;Sep&quot;  &quot;Oct&quot;  &quot;Nov&quot;  &quot;Dec&quot;</code></pre>
<p>类似的，用<code>rownames()</code>函数可以查看行名称。由于我们并没有给各行起名字，R默认按数字顺序命名。我们可以将年份列作为行名称：</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rownames</span>(mydata2)</code></pre></div>
<pre><code>##  [1] &quot;1&quot;  &quot;2&quot;  &quot;3&quot;  &quot;4&quot;  &quot;5&quot;  &quot;6&quot;  &quot;7&quot;  &quot;8&quot;  &quot;9&quot;  &quot;10&quot; &quot;11&quot;
## [12] &quot;12&quot; &quot;13&quot; &quot;14&quot; &quot;15&quot; &quot;16&quot; &quot;17&quot; &quot;18&quot; &quot;19&quot; &quot;20&quot; &quot;21&quot; &quot;22&quot;
## [23] &quot;23&quot; &quot;24&quot; &quot;25&quot; &quot;26&quot; &quot;27&quot; &quot;28&quot; &quot;29&quot; &quot;30&quot; &quot;31&quot; &quot;32&quot; &quot;33&quot;
## [34] &quot;34&quot; &quot;35&quot; &quot;36&quot; &quot;37&quot; &quot;38&quot; &quot;39&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rownames</span>(mydata2) &lt;-<span class="st"> </span>mydata2$year
<span class="kw">rownames</span>(mydata2)</code></pre></div>
<pre><code>##  [1] &quot;1959&quot; &quot;1960&quot; &quot;1961&quot; &quot;1962&quot; &quot;1963&quot; &quot;1964&quot; &quot;1965&quot; &quot;1966&quot;
##  [9] &quot;1967&quot; &quot;1968&quot; &quot;1969&quot; &quot;1970&quot; &quot;1971&quot; &quot;1972&quot; &quot;1973&quot; &quot;1974&quot;
## [17] &quot;1975&quot; &quot;1976&quot; &quot;1977&quot; &quot;1978&quot; &quot;1979&quot; &quot;1980&quot; &quot;1981&quot; &quot;1982&quot;
## [25] &quot;1983&quot; &quot;1984&quot; &quot;1985&quot; &quot;1986&quot; &quot;1987&quot; &quot;1988&quot; &quot;1989&quot; &quot;1990&quot;
## [33] &quot;1991&quot; &quot;1992&quot; &quot;1993&quot; &quot;1994&quot; &quot;1995&quot; &quot;1996&quot; &quot;1997&quot;</code></pre>
<p>这样，如果要查看1995年9月的数据，就不用再数第几行第几列了，用行名称和列名称更方便：</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mydata2[<span class="st">&#39;1995&#39;</span>, <span class="st">&#39;Sep&#39;</span>]</code></pre></div>
<pre><code>## [1] 358.11</code></pre>
<p>这对于处理大型的表格尤其方便，省得瞪着眼睛去数数寻找单元格了，很大程度上减少了对视力的伤害。</p>
<p>任何一行或一列，都可以作为向量来计算。我们仿照上一章介绍的向量计算方法，来算一下1995年全年二氧化碳的平均浓度，只要对该行的第2到13列求平均：</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>(mydata2[<span class="st">&#39;1995&#39;</span>, <span class="dv">2</span>:<span class="dv">13</span>]) /<span class="st"> </span><span class="dv">12</span></code></pre></div>
<pre><code>## [1] 360.9142</code></pre>

<div class="lemma">
<span id="lem:lem-mean" class="lemma"><strong>思考 2.3  </strong></span>直接使用平均值函数mean()行不行？为什么？
</div>
<p></p>
<p>如果求1996年比1995年二氧化碳浓度增加了多少，可以料想，只需把两行的平均值相减：</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>(mydata2[<span class="st">&#39;1996&#39;</span>, <span class="dv">2</span>:<span class="dv">13</span>]) /<span class="st"> </span><span class="dv">12</span> -<span class="st"> </span>
<span class="st">  </span><span class="kw">sum</span>(mydata2[<span class="st">&#39;1995&#39;</span>, <span class="dv">2</span>:<span class="dv">13</span>]) /<span class="st"> </span><span class="dv">12</span></code></pre></div>
<pre><code>## [1] 1.7725</code></pre>
<p>那么，1996年每个月比1995年同比增加了多少二氧化碳？</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mydata2[<span class="st">&#39;1996&#39;</span>, ] -<span class="st"> </span>mydata2[<span class="st">&#39;1995&#39;</span>, ]</code></pre></div>
<pre><code>##      year  Jan  Feb Mar  Apr  May  Jun  Jul  Aug Sep  Oct
## 1996    1 2.11 2.26 2.4 1.28 1.63 1.71 1.76 2.04 1.4 1.85
##       Nov  Dec
## 1996 1.19 1.64</code></pre>
<p>这里我们可以体会向量计算的特点，是逐个对应相减的。</p>
<p>现在，你可以试着对任意一行或一列来做向量计算了。</p>

<div class="example">
<span id="exm:ex2-1" class="example"><strong>Example 2.1  </strong></span> 请计算1995年二氧化碳浓度的最大值和最小值。
</div>
<p></p>
<p>整行或整列的计算，在R中有更方便的方法，可以这样：</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">colMeans</span>(mydata2[, <span class="dv">2</span>:<span class="dv">13</span>]) <span class="co"># 排除掉第一列后，对整列求平均</span></code></pre></div>
<pre><code>##      Jan      Feb      Mar      Apr      May      Jun 
## 336.4308 337.2033 338.0546 339.2944 339.8821 339.3282 
##      Jul      Aug      Sep      Oct      Nov      Dec 
## 337.9164 335.9579 334.2428 334.1692 335.4679 336.6946</code></pre>
<p>每年和每月的平均值一下就算出来了。类似的函数还有整行求和<code>rowSum()</code>和整列求和<code>colSum()</code>。函数名很好记，就是在原来函数前面加个<code>row</code>或<code>col</code>，并且注意大小写。</p>
<p>下面，我们对整行求平均值，并且把结果作为一列添加到mydata2中，列名称叫做mean：</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mydata2$mean &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(mydata2[, <span class="dv">2</span>:<span class="dv">13</span>])</code></pre></div>
<p>如果不是求和或求平均值，而是求其他函数值，比如中位数、最大值、最小值呢？难道也是在原函数名前边添个row或者col就行了吗？呃，理论上当然是可以做到的（见第<a href="secfunction.html#secfunction">9</a>章），但实际上没那个必要，因为那样就需要太多的新函数。我们可以用功能更强大的<code>apply()</code>函数：</p>
<p></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mydata2$median &lt;-<span class="st"> </span><span class="kw">apply</span>(<span class="dt">X =</span> mydata2[, <span class="dv">2</span>:<span class="dv">13</span>], 
                        <span class="dt">FUN =</span> median, <span class="dt">MARGIN =</span> <span class="dv">1</span>)</code></pre></div>
<p>这条代码，表示计算对象是mydata2[, 2:13]这个数据框，按行操作（<code>MARGIN = 1</code>），操作的函数是求中位数<code>median</code>。如果把<code>median</code>换成<code>sum</code>或<code>mean</code>，那么就跟<code>rowSums()</code>和<code>rowMeans()</code>的效果完全一样了。想了解<code>apply()</code>函数更多详细情况，请咨询F1小助理。</p>
<p>现在，我们可以用上一章认识的各种数学函数，对这个表格进行随便折腾了。</p>
<p>任意相邻年份某个月的二氧化碳浓度增量，也就是相邻两行的差，可以用<code>diff()</code>函数：</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">diff</span>(mydata2$Sep)</code></pre></div>

<div class="example">
<p><span id="exm:ex2-2" class="example"><strong>Example 2.2  </strong></span>请解释下面代码的含义，猜猜计算出来的结果是什么，再运行，看看跟你猜的是否一致。</p>
<code>apply(X = mydata2, FUN = diff, MARGIN = 2)</code>
</div>
<p></p>
<p>上面我们演示了如何让R读取一个数据文件，并简单分析和作图。从此以后，你就可以依葫芦画瓢来处理真正属于你自己的数据了！</p>
<p>回过头来看，我们上面处理的是表格数据。如果要处理其他格式的数据文件，尽管用我们前面介绍的鼠标选定拷贝到剪贴板的方法也可以达到目的，但是我们仍然建议你用Excel或别的软件将它保存或导出为.csv格式，方便R读取和进一步处理，这是首选方案。并且，我们建议你以后把所有数据都尽量从一开始就保存为 .csv格式，因为它就像全世界语言里的英语，到哪里都通用，几乎任何软件都能打开。如果这仍然满足不了你的需求，那么</p>
<ul>
<li><p>请F1小助理搬出<code>read.table()</code>和<code>scan()</code>函数的帮助文件；</p></li>
<li><p>请阅读《R数据的导入和导出》这本书，来自开源社区，网上免费获取<a href="#fn14" class="footnoteRef" id="fnref14"><sup>14</sup></a>；</p></li>
<li><p>如果经常处理Excel的xls或xlsx文件，请使用R相关的扩展包。这个方法我们会在第<a href="secfunction.html#secfunction">9</a>章介绍。</p>
<pre><code>R说明文档的水平已经远高于开源软件的平均水平了，甚至高过商业软件（特别是SPSS，老是摆出一张臭脸，说“如果你不懂输出的东西是什么含义，那么点击帮助按钮，我们会弹出5行你仍然不会弄懂的火星语。”）</code></pre></li>
</ul>
<!---
>
> The documentation level of R is already much higher than average for open source software and even than some commercial packages (esp. SPSS is notorious for its attitude of "You want to do one of these things. If you don't understand what the output means, click help and we'll pop up five lines of mumbo-jumbo that you're not going to understand either."
>
--->
<blockquote>
<p>— Peter Dalgaard, April 2002</p>
</blockquote>
</div>
<div id="secdata-3" class="section level2">
<h2><span class="header-section-number">2.3</span> 输出：保存文件</h2>
<p>数据文件的保存比读取要简单多了，用<code>write.csv()</code>函数即可。下面的语句把mydata2这个数据保存到c:/r4r文件夹下面，文件命名为“mydata2.csv”。</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">write.csv</span>(mydata2, <span class="dt">file =</span> <span class="st">&#39;c:/r4r/mydata2.csv&#39;</span>)</code></pre></div>

<div class="lemma">
<span id="lem:unnamed-chunk-60" class="lemma"><strong>思考 2.4  </strong></span>用Excel或记事本打开这个新生成的文件，同时也打开原有的co2.csv文件，比较两者有什么不同。
</div>
<p></p>
<p>现在我们可以解释本章开头两条代码的含义了：我们先用<code>dir.create()</code>函数在你电脑里创建了个文件夹，然后用<code>write.csv()</code>函数将一个名为co2的数据经过一系列格式转换后存成了co2.csv文件。</p>
<p></p>
<p>那么co2这个数据最初是怎么跑到我们的电脑里的？是R安装时捆绑自带的。我们可以运行</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>()</code></pre></div>
<p>就可以看到R自带的很多数据文件。这些文件可以在学习R的过程里用来做各种测试。</p>
<p>在后面的章节中，如无例外，我们都使用R自带的数据做示例，省却读入数据的步骤。当然，如果想练习数据的读入，那么可以用本章开头的方法，把R自带数据存成数据文件，然后装作自己的文件从头操作。</p>
<p>今天的活儿干完了。我们关闭RStudio，收工。RStudio会弹出一个窗口，问你两件事（图<a href="secdata.html#fig:img-save">2.2</a>）：</p>
<div class="figure" style="text-align: center"><span id="fig:img-save"></span>
<img src="images/img-save.png" alt="RStudio退出前保存." width="100%" />
<p class="caption">
图 2.2: RStudio退出前保存.
</p>
</div>
<ol style="list-style-type: decimal">
<li><p>你要不要把工作区存到一个.RData文件里？翻译过来就是：“主人，你要不要我把今天算出来这些数据记在我脑子里，就是右上面板工作区Environment标签下列出的里那些东西，下回打开我的时候直接就能用这些数据？” 保不保存随你心意。我们一般选择不保存，让RStudio把数据忘得一干二净，下回打开时右上方的窗口是空的，只需重新读入数据和计算就行了，反正原始数据在，而数据的处理方法都在代码里。</p></li>
<li><p>你要不要保存r代码？也就是左上方窗口这些东东？当然保存了。</p></li>
</ol>
<p>现在，才算是真正收工了。</p>

<div class="theorem">
<span id="thm:thm-data" class="theorem"><strong>小贴士 2.2  </strong></span>数据操作
</div>
<p></p>
<table>
<thead>
<tr class="header">
<th align="left">操作</th>
<th align="left">提示</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">设定数据文件路径</td>
<td align="left">路径里不要空格，不要中文，用斜线分隔，file.choose()</td>
</tr>
<tr class="even">
<td align="left">读取数据</td>
<td align="left">read.table()，read.csv()</td>
</tr>
<tr class="odd">
<td align="left">保存文件</td>
<td align="left">write.csv()</td>
</tr>
<tr class="even">
<td align="left">选取单元格</td>
<td align="left">x[2, 3]，x[2, ]，x[, 3]，x$Sep，x[‘1995’, ‘Sep’]</td>
</tr>
<tr class="odd">
<td align="left">快速掌握数据</td>
<td align="left">plot()，summary()</td>
</tr>
<tr class="even">
<td align="left">行列名称</td>
<td align="left">rownames()，colnames()，names()，</td>
</tr>
<tr class="odd">
<td align="left">行列计算</td>
<td align="left">rowMeans()，colMeans()，rowSum()，colSum()， apply()</td>
</tr>
</tbody>
</table>
</div>
<div id="secdatapost" class="section level2">
<h2><span class="header-section-number">2.4</span> 课外活动：有R伴我走天涯</h2>
<p>R不仅可以安装在本地，还可以从网络访问。在你的手机或电脑里打开浏览器，访问下面介绍的网站，就可以使用R语言了。</p>
<p>我们先来试试Ideone<a href="#fn15" class="footnoteRef" id="fnref15"><sup>15</sup></a>。打开这个网站后，输入图<a href="secdata.html#fig:img-ideone">2.3</a>上方窗口里的代码，点击<code>Run!</code>按钮运行，窗口下面就立刻显示运算结果。 </p>
<div class="figure" style="text-align: center"><span id="fig:img-ideone"></span>
<img src="images/img-ideone.png" alt="R在线调试网站Ideone." width="100%" />
<p class="caption">
图 2.3: R在线调试网站Ideone.
</p>
</div>
<p>Ideone可以让我们用浏览器来进行R编程和调试，非常方便。喜欢的话，可以注册个免费账号，这样就可以将一些代码保存在自己名下，方便以后调用。它还支持把代码嵌入到网页里，以便分享。</p>
<p>由于输入输出接口的限制，Ideone里的R语言不能读入外部数据，也不能实现作图。另一个网站RWeb<a href="#fn16" class="footnoteRef" id="fnref16"><sup>16</sup></a>则解决了这些问题，支持从本地或网络上导入数据，并可以输出图片。</p>
<p>如果你有自己的服务器，那么还可以用RStudio的服务器版来搭建自己专属的R网站，你的地盘你做主。</p>
<p>有了这些在线的R网站，随时随处都可以免费使用R，没有电脑就用手机。有R伴我走天涯，走到哪里都不怕。</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="11">
<li id="fn11"><p>统计之都 R 语言论坛：<a href="https://d.cosx.org/t/r" class="uri">https://d.cosx.org/t/r</a><a href="secdata.html#fnref11">↩</a></p></li>
<li id="fn12"><p>爆栈网R语言论坛：<a href="http://stackoverflow.com/questions/tagged/r" class="uri">http://stackoverflow.com/questions/tagged/r</a><a href="secdata.html#fnref12">↩</a></p></li>
<li id="fn13"><p>益辉的中文博客：<a href="https://yihui.name/cn/" class="uri">https://yihui.name/cn/</a><a href="secdata.html#fnref13">↩</a></p></li>
<li id="fn14"><p>R数据的导入和导出：<a href="http://pem.freeshell.org/math/R_data_import_export_zh.pdf" class="uri">http://pem.freeshell.org/math/R_data_import_export_zh.pdf</a><a href="secdata.html#fnref14">↩</a></p></li>
<li id="fn15"><p>Ideone：<a href="http://ideone.com" class="uri">http://ideone.com</a><a href="secdata.html#fnref15">↩</a></p></li>
<li id="fn16"><p>RWeb：<a href="http://pbil.univ-lyon1.fr/Rweb/" class="uri">http://pbil.univ-lyon1.fr/Rweb/</a><a href="secdata.html#fnref16">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="secstart.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="secplot.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["r4r.pdf"],
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
